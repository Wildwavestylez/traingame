<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hra s Vláčky</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        #map {
            height: 100vh; /* Celá výška okna */
        }
        /* Styl pro vyskakovací okno */
        .modal {
            display: none; /* Skryté ve výchozím nastavení */
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0,0,0);
            background-color: rgba(0,0,0,0.4);
        }

        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        .station-btn {
            display: block;
            margin: 5px 0;
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }

        .station-btn:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>

<div id="map"></div>

<!-- Vyskakovací okno pro výběr stanice -->
<div id="station-selection-modal" class="modal">
    <div class="modal-content">
        <span class="close" id="close-modal">&times;</span>
        <h2>Vyberte startovní stanici</h2>
        <div id="station-list"></div>
        <button id="start-game-btn">Začít hru</button>
    </div>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
    // Inicializace mapy Leaflet
    const map = L.map('map').setView([50.0252381, 15.2142544], 7);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '© OpenStreetMap contributors'
    }).addTo(map);

    const openRailwayMapLayer = new L.TileLayer('http://{s}.tiles.openrailwaymap.org/standard/{z}/{x}/{y}.png', {
        attribution: '© OpenRailwayMap contributors, Style: CC-BY-SA 2.0 OpenRailwayMap and OpenStreetMap',
        minZoom: 2,
        maxZoom: 19,
        tileSize: 256
    }).addTo(map);

    // Definice linek
    const lines = [
        {
            name: "Trať 253 Břeclav – Lednice",    
            color: "#FFFFFF00",
            category: "A",
            trains: [
                { name: "Břeclav – Lednice", startingIndex: 0, reverse: false, image: 'https://i.imgur.com/qjrg4Ow.png', maxSpeed: 500 }
            ],
            stops: [
                { name: "Břeclav", location: [48.7536203, 16.8930283] },
                { name: "Boří les", location: [48.7379150, 16.8671475] },
                { name: "Poštorná", location: [48.7508392, 16.8519497] },  
                { name: "Charvátská Nová Ves", location: [48.7598800, 16.8422889] },
                { name: "Lednice rybníky", location: [48.7810556, 16.8032456] },
                { name: "Lednice", location: [48.7941400, 16.8016453] },
            ]
        }
    ];

    // Seznam stanic na základě linek
    function getStationsFromLines(lines) {
        const stations = new Set();
        lines.forEach(line => {
            line.stops.forEach(stop => {
                stations.add(stop.name);
            });
        });
        return Array.from(stations);
    }

    // Inicializace vyskakovacího okna
    const stationModal = document.getElementById('station-selection-modal');
    const stationList = document.getElementById('station-list');
    const closeModal = document.getElementById('close-modal');

    function showStationSelection() {
        const stations = getStationsFromLines(lines);
        stationList.innerHTML = stations.map(station => `<button class="station-btn">${station}</button>`).join('');
        stationModal.style.display = 'block';
    }

    closeModal.onclick = function() {
        stationModal.style.display = 'none';
    }

    window.onclick = function(event) {
        if (event.target === stationModal) {
            stationModal.style.display = 'none';
        }
    }

    stationList.addEventListener('click', function(event) {
        if (event.target.classList.contains('station-btn')) {
            // Zpracování výběru stanice
            const selectedStation = event.target.textContent;
            console.log("Vybraná stanice: ", selectedStation);
            // Uložení výběru a zavření modalu
            stationModal.style.display = 'none';
            // Můžete pokračovat s logikou pro zahájení hry zde
        }
    });

    // Spustí se po načtení stránky
    window.onload = function() {
        showStationSelection();
    }
</script>

</body>
</html>

