<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Train Game</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    #map {
      width: 100%;
      height: 600px;
    }
    #info {
      position: absolute;
      top: 10px;
      left: 10px;
      background-color: rgba(255, 255, 255, 0.7);
      padding: 10px;
      border-radius: 5px;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <div id="map"></div>
  <div id="info">Money: $0</div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    // Map initialization
    var map = L.map('map').setView([48.8675378, 21.8248364], 13); // Example: Strážské coordinates

    // Add tile layer (OpenStreetMap)
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    // Train icon setup
    var trainIcon = L.icon({
      iconUrl: 'https://example.com/train-icon.png', // Replace with actual icon URL
      iconSize: [32, 32],
      iconAnchor: [16, 16],
      popupAnchor: [0, -16]
    });

    // Data for lines and stations
    const lines = [
      {
        name: "Trať 192 STRÁŽSKÉ - TREBIŠOV",
        color: "#FFFFFF00",
        category: "A",
        locked: true, // Line is locked initially
        trains: [
          { name: "STRÁŽSKÉ - TREBIŠOV", startingIndex: 0, reverse: false, image: 'https://i.imgur.com/sgF74F8.png', maxSpeed: 600 },
          { name: "STRÁŽSKÉ - TREBIŠOV", startingIndex: 8, reverse: false, image: 'https://i.imgur.com/5V3WrS7.png', maxSpeed: 600 }
        ],
        stops: [
          { name: "Strážské", location: [48.8675378, 21.8248364], locked: true },
          { name: "Nižný Hrabovec", location: [48.8570392, 21.7518606], locked: true },
          { name: "Hencovce", location: [48.8570392, 21.7518606], locked: true },
          { name: "Vranovské Dlhé", location: [48.8695603, 21.7053108], locked: true },
          { name: "Vranov nad Topľou", location: [48.8900675, 21.6740197], locked: true },
          { name: "Komárany", location: [48.9131272, 21.6385608], locked: true },
          { name: "Soľ", location: [48.9319739, 21.6005106], locked: true },
          { name: "Hlinné", location: [48.9529000, 21.5841294], locked: true },
          { name: "Čierne nad Topľou", location: [48.9897806, 21.5694306], locked: true },
          { name: "Bystré", location: [49.0033111, 21.5423933], locked: true }
        ]
      }
    ];

    // Money tracking
    var money = 0;
    function increaseMoney(amount) {
      money += amount;
      document.getElementById('info').textContent = 'Money: $' + money;
    }

    // Simulate moving train and unlocking stations
    function moveTrain() {
      var trainLine = lines[0]; // Example for line 192
      if (trainLine.locked) {
        alert("This line is locked! Unlock it first.");
        return;
      }

      // Move train logic (simplified)
      var trainMarker = L.marker(trainLine.trains[0].image, {
        position: trainLine.stops[0].location
      }).addTo(map);

      // Unlock stations and lines after meeting conditions (e.g., money)
      if (money >= 100) {
        unlockLine(0); // Unlock line 192
        unlockStation(0, 0); // Unlock first station (Strážské)
      }
    }

    // Unlock a specific station
    function unlockStation(lineIndex, stationIndex) {
      lines[lineIndex].stops[stationIndex].locked = false;
      alert("Station " + lines[lineIndex].stops[stationIndex].name + " unlocked!");
    }

    // Unlock a specific line
    function unlockLine(lineIndex) {
      lines[lineIndex].locked = false;
      alert("Line " + lines[lineIndex].name + " unlocked!");
    }

    // Simulate a moving train every 3 seconds
    setInterval(moveTrain, 3000);

  </script>
</body>
</html>
